<section class="admin-dashboard container-fluid font-cairo">

  @if (isRootAdmin()) {

  <div class="dashboard-top-section p-4">

    <div class="d-flex flex-wrap align-items-end justify-content-between fade-in-down">
      <div>
        <div class="badge role-badge mb-3">
          <i class="bi bi-shield-lock-fill me-2"></i>منطقة الإدارة العليا
        </div>
        <h1 class="fw-bold text-dark mb-1 ls-tight">
          {{ greeting }}, <span class="text-brand">Admin</span>
        </h1>
        <p class="text-muted fs-5 mb-0">إليك نظرة عامة على ما يحدث في نظامك اليوم.</p>
      </div>

      <div class="d-none d-md-block text-end">
        <div class="text-muted small fw-bold text-uppercase ls-1 mb-1">تاريخ اليوم</div>
        <div class="h5 fw-bold text-dark m-0 d-flex align-items-center gap-2 justify-content-end">
          {{ today | date : 'fullDate' }}
          <i class="bi bi-calendar-event text-brand"></i>
        </div>
      </div>
    </div>

    <div class="spacer-40"></div>
    <br>

    <div class="row g-4 fade-in-up">
      <div class="col-md-4">
        <div class="stat-card bg-white p-4 h-100 border-bottom-brand position-relative overflow-hidden">
          <div class="d-flex justify-content-between align-items-start z-1 position-relative">
            <div>
              <p class="text-muted small fw-bold text-uppercase ls-1 mb-2">إجمالي المستخدمين</p>
              <h2 class="fw-bolder text-dark mb-2">{{ usersCounts.owners + usersCounts.renters }}</h2>
              <div class="badge bg-success bg-opacity-10 text-success rounded-pill px-2 py-1">
                <i class="bi bi-arrow-up-right small"></i> نشط
              </div>
            </div>
            <div class="icon-shape bg-brand-light text-brand">
              <i class="bi bi-people-fill fs-4"></i>
            </div>
          </div>
          <i class="bi bi-people-fill bg-icon text-brand"></i>
        </div>
      </div>
      <div class="col-md-4">
        <div class="stat-card bg-white p-4 h-100 border-bottom-warning position-relative overflow-hidden">
          <div class="d-flex justify-content-between align-items-start z-1 position-relative">
            <div>
              <p class="text-muted small fw-bold text-uppercase ls-1 mb-2">بلاغات معلقة</p>
              <h2 class="fw-bolder text-dark mb-2">{{ adminReportCounts.pendingCount }}</h2>
              <div class="badge bg-warning bg-opacity-10 text-warning rounded-pill px-2 py-1">
                <i class="bi bi-exclamation-circle small"></i> يتطلب إجراء
              </div>
            </div>
            <div class="icon-shape bg-warning bg-opacity-10 text-warning">
              <i class="bi bi-flag-fill fs-4"></i>
            </div>
          </div>
          <i class="bi bi-flag-fill bg-icon text-warning"></i>
        </div>
      </div>
      <div class="col-md-4">
        <div class="stat-card bg-white p-4 h-100 border-bottom-success position-relative overflow-hidden">
          <div class="d-flex justify-content-between align-items-start z-1 position-relative">
            <div>
              <p class="text-muted small fw-bold text-uppercase ls-1 mb-2">نسبة المراجعة</p>
              <h2 class="fw-bolder text-dark mb-2">{{ triagedPercent }}%</h2>
              <div class="badge bg-success bg-opacity-10 text-success rounded-pill px-2 py-1">
                <i class="bi bi-check-circle small"></i> مكتمل
              </div>
            </div>
            <div class="icon-shape bg-success bg-opacity-10 text-success">
              <i class="bi bi-activity fs-4"></i>
            </div>
          </div>
          <i class="bi bi-activity bg-icon text-success"></i>
        </div>
      </div>
    </div>


  </div>
  }

  <div class="content-fill-area p-4">
    <router-outlet></router-outlet>
  </div>

  @if (isRootAdmin()) {
  <div class="nav-container p-4 mt-auto fade-in-up">
    <div
      class="glass-nav p-2 rounded-4 shadow-sm border border-white d-flex justify-content-between align-items-center">

      <nav class="nav nav-pills nav-fill flex-nowrap custom-scrollbar overflow-auto">
        <a class="nav-link rounded-pill fw-bold small px-3 mx-1 d-flex align-items-center gap-2" routerLink="/admin"
          routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">
          <i class="bi bi-grid-fill"></i> <span>الرئيسية</span>
        </a>

        <a class="nav-link rounded-pill fw-bold small px-3 mx-1 d-flex align-items-center gap-2"
          routerLink="/admin/reports" routerLinkActive="active">
          <i class="bi bi-file-earmark-text-fill"></i> <span>البلاغات</span>
          <span class="badge bg-danger rounded-circle ms-1"
            style="font-size: 0.6em">{{adminReportCounts.pendingCount}}</span>
        </a>

        <a class="nav-link rounded-pill fw-bold small px-3 mx-1 d-flex align-items-center gap-2"
          routerLink="/admin/users" routerLinkActive="active">
          <i class="bi bi-people-fill"></i> <span>المستخدمين</span>
        </a>

        <a class="nav-link rounded-pill fw-bold small px-3 mx-1 d-flex align-items-center gap-2 text-danger"
          (click)="logout()" routerLinkActive="active" role="button" tabindex="0" (keyup.enter)="logout()"
          (keyup.space)="logout()" style="--bs-nav-pills-link-active-bg: var(--bs-danger);">
          <i class="bi bi-box-arrow-right me-1"></i> <span>خروج</span>
        </a>
      </nav>

      <div class="d-none d-md-flex ps-3 border-start border-secondary border-opacity-10">
        <button class="btn btn-light btn-icon rounded-circle shadow-sm me-2" title="تحديث">
          <i class="bi bi-arrow-clockwise text-secondary"></i>
        </button>
      </div>
    </div>
  </div>
  }

</section>